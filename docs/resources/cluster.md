---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cockroach_cluster Resource - terraform-provider-cockroach"
subcategory: ""
description: |-
  CockroachDB Cloud cluster.
---

# cockroach_cluster (Resource)

CockroachDB Cloud cluster.

## Example Usage

```terraform
resource "cockroach_cluster" "advanced" {
  name           = "cockroach-advanced"
  cloud_provider = "GCP"
  plan           = "ADVANCED"
  dedicated = {
    storage_gib  = 15
    machine_type = "n2-standard-4"
  }
  regions = [
    {
      name       = "us-central1"
      node_count = 1
    }
  ]
  delete_protection = true
  backup_config = {
    enabled           = true
    frequency_minutes = 60
    retention_days    = 30
  }
}

resource "cockroach_cluster" "standard" {
  name           = "cockroach-standard"
  cloud_provider = "GCP"
  plan           = "STANDARD"
  serverless = {
    usage_limits = {
      provisioned_virtual_cpus = 2
    }
    upgrade_type = "AUTOMATIC"
  }
  regions = [
    {
      name = "us-east1"
    }
  ]
  delete_protection = false
  backup_config = {
    enabled           = true
    frequency_minutes = 60
    retention_days    = 30
  }
}

resource "cockroach_cluster" "basic" {
  name           = "cockroach-basic"
  cloud_provider = "GCP"
  plan           = "BASIC"
  serverless     = {}
  regions = [
    {
      name = "us-east1"
    }
  ]
  delete_protection = false
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud_provider` (String) Cloud provider used to host the cluster. Allowed values are:
  * GCP
  * AWS
  * AZURE
- `name` (String) Name of the cluster.
- `regions` (Attributes List) (see [below for nested schema](#nestedatt--regions))

### Optional

- `backup_config` (Attributes) The backup settings for a cluster.
 Each cluster has backup settings that determine if backups are enabled, how frequently they are taken, and how long they are retained for. Use this attribute to manage those settings. (see [below for nested schema](#nestedatt--backup_config))
- `cockroach_version` (String) Major version of CockroachDB running on the cluster. This value can be used to orchestrate version upgrades. Supported for ADVANCED and STANDARD clusters (when `serverless.upgrade_type` set to 'MANUAL').
- `dedicated` (Attributes) (see [below for nested schema](#nestedatt--dedicated))
- `delete_protection` (Boolean) Set to true to enable delete protection on the cluster. If unset, the server chooses the value on cluster creation, and preserves the value on cluster update.
- `parent_id` (String) The ID of the cluster's parent folder. 'root' is used for a cluster at the root level.
- `plan` (String) Denotes cluster plan type: 'BASIC' or 'STANDARD' or 'ADVANCED'.
- `serverless` (Attributes) (see [below for nested schema](#nestedatt--serverless))

### Read-Only

- `account_id` (String) The cloud provider account ID that hosts the cluster. Needed for CMEK and other advanced features.
- `creator_id` (String) ID of the user who created the cluster.
- `id` (String) The ID of this resource.
- `operation_status` (String) Describes the current long-running operation, if any.
- `state` (String) Describes whether the cluster is being created, updated, deleted, etc.
- `upgrade_status` (String) Describes the status of any in-progress CockroachDB upgrade or rollback.

<a id="nestedatt--regions"></a>
### Nested Schema for `regions`

Required:

- `name` (String) Name of the region. Should match the region code used by the cluster's cloud provider.

Optional:

- `node_count` (Number) Number of nodes in the region. Valid for Advanced clusters only.
- `primary` (Boolean) Set to true to mark this region as the primary for a serverless cluster. Exactly one region must be primary. Dedicated clusters expect to have no primary region.

Read-Only:

- `internal_dns` (String) Internal DNS name of the cluster within the cloud provider's network. Used to connect to the cluster with PrivateLink or VPC peering.
- `sql_dns` (String) DNS name of the cluster's SQL interface. Used to connect to the cluster with IP allowlisting.
- `ui_dns` (String) DNS name used when connecting to the DB Console for the cluster.


<a id="nestedatt--backup_config"></a>
### Nested Schema for `backup_config`

Optional:

- `enabled` (Boolean) Indicates whether backups are enabled. If set to false, no backups will be created.
- `frequency_minutes` (Number) The frequency of backups in minutes.  Valid values are [5, 10, 15, 30, 60, 240, 1440]
- `retention_days` (Number) The number of days to retain backups for.  Valid values are [2, 7, 30, 90, 365]. Can only be set once, further changes require opening a support ticket. See [Updating backup retention](../guides/updating-backup-retention) for more information.


<a id="nestedatt--dedicated"></a>
### Nested Schema for `dedicated`

Optional:

- `cidr_range` (String) The IPv4 range in CIDR format that will be used by the cluster. This is supported only on GCP, and must have a subnet mask no larger than /19. Defaults to "172.28.0.0/14". This cannot be changed after cluster creation.
- `disk_iops` (Number) Number of disk I/O operations per second that are permitted on each node in the cluster. Zero indicates the cloud provider-specific default.
- `machine_type` (String) Machine type identifier within the given cloud provider, e.g., m6.xlarge, n2-standard-4.
- `num_virtual_cpus` (Number) Number of virtual CPUs per node in the cluster.
- `private_network_visibility` (Boolean) Set to true to assign private IP addresses to nodes. Required for CMEK and other advanced networking features. Clusters created with this flag will have advanced security features enabled.  This cannot be changed after cluster creation and incurs additional charges.  See [Create an Advanced Cluster](https://www.cockroachlabs.com/docs/cockroachcloud/create-an-advanced-cluster.html#step-6-configure-advanced-security-features) and [Pricing](https://www.cockroachlabs.com/pricing/) for more information.
- `storage_gib` (Number) Storage amount per node in GiB.

Read-Only:

- `memory_gib` (Number) Memory per node in GiB.


<a id="nestedatt--serverless"></a>
### Nested Schema for `serverless`

Optional:

- `spend_limit` (Number, Deprecated) Spend limit in US cents.
- `upgrade_type` (String) Dictates the behavior of CockroachDB major version upgrades. Manual upgrades are not supported on CockroachDB Basic. Manual or automatic upgrades are supported on CockroachDB Standard. If you omit the field, it defaults to `AUTOMATIC`. Allowed values are:
  * MANUAL
  * AUTOMATIC
- `usage_limits` (Attributes) (see [below for nested schema](#nestedatt--serverless--usage_limits))

Read-Only:

- `routing_id` (String) Cluster identifier in a connection string.

<a id="nestedatt--serverless--usage_limits"></a>
### Nested Schema for `serverless.usage_limits`

Optional:

- `provisioned_virtual_cpus` (Number) Maximum number of vCPUs that the cluster can use.
- `request_unit_limit` (Number) Maximum number of Request Units that the cluster can consume during the month.
- `storage_mib_limit` (Number) Maximum amount of storage (in MiB) that the cluster can have at any time during the month.

## Import

Import is supported using the following syntax:

```shell
# format: <cluster id>
terraform import cockroach_cluster.my_cluster 1f69fdd2-600a-4cfc-a9ba-16995df0d77d
```
