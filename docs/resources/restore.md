---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cockroach_restore Resource - terraform-provider-cockroach"
subcategory: ""
description: |-
  CockroachDB Cloud restore. Used to start a restore job from a managed backup.
---

# cockroach_restore (Resource)

CockroachDB Cloud restore. Used to start a restore job from a managed backup.

## Example Usage

```terraform
resource "cockroach_restore" "cluster_restore" {
  destination_cluster_id = "12345678-1234-4123-8123-123456789abc"
  type                   = "CLUSTER"
  source_cluster_id      = "22222222-2222-4222-8222-222222222222"
}

resource "cockroach_restore" "database_restore" {
  destination_cluster_id = "12345678-1234-4123-8123-123456789abc"
  type                   = "DATABASE"
  source_cluster_id      = "22222222-2222-4222-8222-222222222222"

  restore_opts = {
    new_db_name = "new_database"
    schema_only = true
  }

  objects {
    database = "database1"
  }
}

resource "cockroach_restore" "table_restore" {
  destination_cluster_id = "12345678-1234-4123-8123-123456789abc"
  type                   = "TABLE"
  backup_id              = "11111111-1111-4111-8111-111111111111"

  restore_opts = {
    into_db                   = "other_database"
    skip_localities_check     = true
    skip_missing_foreign_keys = true
    skip_missing_sequences    = true
  }

  objects {
    database = "database1"
    schema   = "schema1"
    tables   = ["table_a", "table_b"]
  }

  objects {
    database = "database2"
    schema   = "schema2"
    tables   = ["table_c"]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `destination_cluster_id` (String) ID of the cluster where the backup will be restored.
- `type` (String) Type describes the scope of the restore job. When using a DATABASE or TABLE restore, additional details must be passed in the objects attribute. Allowed values are: `CLUSTER` or `DATABASE` or `TABLE`.

### Optional

- `backup_id` (String) ID of the managed backup from which data will be restored. If this value is not set, the restore job uses the most recent available backup on the source cluster.
- `objects` (Block List) The list of objects to restore. Required when the restore job type is `DATABASE` or `TABLE`. (see [below for nested schema](#nestedblock--objects))
- `restore_opts` (Attributes) Additional options controlling the behavior of the restore job. (see [below for nested schema](#nestedatt--restore_opts))
- `source_cluster_id` (String) ID of the source cluster containing the managed backup to be restored.

### Read-Only

- `backup_end_time` (String) The timestamp at which the backup data was captured.
- `client_error_code` (Number) Error code from the restore job, only populated if it has failed.
- `client_error_message` (String) Error message from the restore job, only populated if it has failed.
- `completed_at` (String) The timestamp at which the restore job completed.
- `completion_percent` (Number) Decimal value showing the percentage of the restore job that has been completed. Value ranges from 0 to 1.
- `crdb_job_id` (String) The CockroachDB internal job ID for the restore job.
- `created_at` (String) The time at which the restore job was initiated.
- `destination_cluster_name` (String) The name of the cluster to which the restore is being applied.
- `id` (String) The ID of this resource.
- `source_cluster_name` (String) The name of the cluster from which the backup was taken.
- `status` (String) The current status of the restore job.

<a id="nestedblock--objects"></a>
### Nested Schema for `objects`

Required:

- `database` (String) The database name in the fully qualified name of the objects to be restored. In the case of a job that restores `tpcc.public.warehouse`, this value would be `tpcc`.

Optional:

- `schema` (String) The schema name in the fully qualified name of the objects to be restored. In the case of a job that restores `tpcc.public.warehouse`, this value would be `public`.
- `tables` (List of String) The table name in the fully qualified name of the objects to be restored. In the case of a job that restores `tpcc.public.warehouse`, this would value be `warehouse`.


<a id="nestedatt--restore_opts"></a>
### Nested Schema for `restore_opts`

Optional:

- `into_db` (String) Optionally specifies a target database to restore the table into during a table restore job. If not set, the table is restored into the database it belonged to in the source backup.
- `new_db_name` (String) Optionally specifies the name of a new database to create as the target of a database restore job. If not set, the name defaults to the original database name from the source cluster.
- `schema_only` (Boolean) If set, only the schema without any user data is restored.
- `skip_localities_check` (Boolean) Allows the restore job to continue in the event that there are mismatched localities between the backup and target cluster. Useful when restoring multi-region tables to a cluster missing some localities.
- `skip_missing_foreign_keys` (Boolean) Allows a table to be restored even if it has foreign key constraints referencing rows that no longer exist in the target cluster.
- `skip_missing_sequences` (Boolean) Allows a table to be restored even if it contains a column whose `DEFAULT` value depends on a sequence. More information can be found [here](https://www.cockroachlabs.com/docs/stable/show-sequences).
- `skip_missing_views` (Boolean) Allows the job to skip restoring views that cannot be restored because their dependencies are not included in the current restore job.
